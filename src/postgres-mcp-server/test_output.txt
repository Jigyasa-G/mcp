============================= test session starts ==============================
platform darwin -- Python 3.10.17, pytest-8.4.1, pluggy-1.6.0 -- /Users/gupjigz/.local/share/mise/installs/python/3.10.17/bin/python
cachedir: .pytest_cache
rootdir: /Users/gupjigz/Desktop/mcp-apg/mcp-internal/mcp/src/postgres-mcp-server
configfile: pyproject.toml
testpaths: tests
plugins: anyio-4.9.0, asyncio-1.0.0
asyncio: mode=auto, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 27 items

tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_connection_initialization PASSED [  3%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_connection_readonly_timeout PASSED [  7%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_connection_execute_query PASSED [ 11%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_pool_stats PASSED [ 14%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_connection_timeout_behavior PASSED [ 18%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_pool_min_size PASSED [ 22%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_pool_max_size PASSED [ 25%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_connection_pool_concurrent_acquisition PASSED [ 29%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_connection_pool_max_size_enforcement PASSED [ 33%]
tests/test_psycopg_connector.py::TestPsycopgConnector::test_connection_pool_timeout_with_concurrency PASSED [ 37%]
tests/test_server.py::test_run_query_well_formatted_response PASSED      [ 40%]
tests/test_server.py::test_run_query_safe_read_queries_on_redonly_settings PASSED [ 44%]
tests/test_server.py::test_run_query_risky_queries_without_parameters PASSED [ 48%]
tests/test_server.py::test_run_query_throw_client_error PASSED           [ 51%]
tests/test_server.py::test_run_query_throw_unexpected_error PASSED       [ 55%]
tests/test_server.py::test_run_query_write_queries_on_readonly_setting PASSED [ 59%]
tests/test_server.py::test_run_query_write_queries_on_write_allowed_setting PASSED [ 62%]
tests/test_server.py::test_get_table_schema PASSED                       [ 66%]
tests/test_server.py::test_main_with_valid_parameters PASSED             [ 70%]
tests/test_server.py::test_main_with_invalid_parameters PASSED           [ 74%]
tests/test_server.py::test_run_query_with_psycopg_connection PASSED      [ 77%]
tests/test_server.py::test_main_with_psycopg_parameters PASSED           [ 81%]
tests/test_server.py::test_main_with_invalid_psycopg_parameters PASSED   [ 85%]
tests/test_singleton.py::TestDBConnectionSingleton::test_singleton_initialization PASSED [ 88%]
tests/test_singleton.py::TestDBConnectionSingleton::test_singleton_validation_missing_params PASSED [ 92%]
tests/test_singleton.py::TestDBConnectionSingleton::test_singleton_get_without_initialization PASSED [ 96%]
tests/test_singleton.py::TestDBConnectionSingleton::test_singleton_cleanup PASSED [100%]/Users/gupjigz/.local/share/mise/installs/python/3.10.17/lib/python3.10/site-packages/_pytest/unraisableexception.py:33: RuntimeWarning: coroutine 'RDSDataAPIConnection.close' was never awaited
  gc.collect()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback


=============================== warnings summary ===============================
tests/test_psycopg_connector.py::TestPsycopgConnector::test_psycopg_connection_readonly_timeout
  /Users/gupjigz/Desktop/mcp-apg/mcp-internal/mcp/src/postgres-mcp-server/awslabs/postgres_mcp_server/connection/psycopg_pool_connection.py:116: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    async with self.pool.connection(timeout=15.0) as conn:
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================== 27 passed, 1 warning in 1.36s =========================
